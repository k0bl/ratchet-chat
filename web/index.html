<head>
	<script src="lib/jquery.js"></script>
</head>
<body>

<h2>Welcome to the chat application</h2>
<div class="chat-top">
	<label>Your Name:</label>
	<input id="name"></input>
</div>
<div class="message-display">
	<span id="sender-name"></span>
	<span id="message-content"></span>
</div>

<div class="message-composition">
	<label>Your Message: </label>
	<input id="message"></input> <button id="send">Send</button>
</div>



<script>
   	$(document).ready(function(){
   		var conn = new WebSocket('ws://localhost:8080');
		conn.onopen = function(e) {
		    console.log("Connection established!");
		};

		conn.onmessage = function(e) {
		    console.log(e.data);
			var test_str = e.data;
			var sender_start_pos = test_str.indexOf('sender:') + 8;
			var sender_end_pos = test_str.indexOf(',',sender_start_pos);
			var sender_text = test_str.substring(sender_start_pos, sender_end_pos);
			var msg_start_pos = test_str.indexOf('message:') + 8;
			var msg_end_pos = test_str.indexOf('}',msg_start_pos);
			var msg_text = test_str.substring(msg_start_pos, msg_end_pos);
			var msg_content_text = sender_text+": "+msg_text;
		    $("#message-content").append(msg_content_text+ "<br />"); 
		};
		
		$("#send").click(function(){
			var messageContent = $('#message').val();
			var senderName = $('#name').val();
			var message = "{sender: "+senderName+","+"message: "+messageContent+"}";
			conn.send(message);
			$("#message-content").append(senderName+ ": "+messageContent+"<br />"); 
		});

    })
</script>
<style>
#chat-top {
	margin-top: 20px;
	margin-bottom: 40px;
}
#message-display {
	width: 600px;
	min-height: 100px; 
	border: 1px solid black;
	margin-bottom: 20px;
}
#message-composition {

}
</style>
</body>